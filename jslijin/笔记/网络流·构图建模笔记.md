【一般有向图转化为二分图】

拆点为入点和出点，出入为二分图的两部，边方向由出指向入

【行列二分图模型】

网格或者坐标下，将x轴y轴抽象成二分图两部，行列的关系或者格点为无向边

每一行，每一列总的限制为源汇边的容量，二分图中的边容量为格点的贡献或者说代价

【获利成本二分图模型】

一般左边为获利，右边为代价，中间边容量正无穷；

经典例子：最大权闭合图，正权看成获利，负权的绝对值看成代价，构造二分图，答案=正权和-最小割

【供应需求二分图模型】

一般左边为供应，右边为需求，中间边容量根据情况而定（常为1）

【排列贡献模型】

所有等价类或者不同对象排成一列，源点S向每个对象引一条有向边，容量为频度，是一种供流限制

二分图的右边，按照贡献的分类建图，常常是对题给答案有贡献的诸多整体，每个整体向汇点T引有向边，容量体现为该整体的承受流的能力（承流限制）

二分图里的边，容量体现为对象最多给整体配送多少个流（配流限制），费用为流对答案的贡献（费用是流的函数）

所有的源汇边费用为0；此处，对答案有贡献的整体，经常是下标的集合，也就是下标全集的分划

一个可行的流，可以解释为，一个字母安排在某个位置；满流常常用以判断解的存在性

【费用为流的函数】

拆边分流，将一条原来的边，拆成若干条，容量卡为单位流，费用依次设为流函数的差分f(k)-f(k-1)，其差分应该不降

【黑白染色二分图模型】

网格模型，相邻格点染异色，黑白为两部，邻关系为边，经常转化为顶点覆盖集与独立集问题

【奇偶和质对二分图模型】

无1的数集，数对满足两数和为质数，称和质对；任一对两数必一奇一偶，经常用以建二分图

【最小割模型边的必取与必不取】

必不取边，只需要将容量设为正无穷；必取边，则需要存在s到t的一条通过此边的路径，除此边外其他边容量均设为正无穷

【最小点权覆盖模型】

对原二分图每条边，满足至少取两个端点中的一个，求所取点权最小和

源s连左边每个点，右边每个点连汇t，容量均为点权；二分图中改单向边，容量为正无穷

对于每个二分图中的边，s与t存在一个路径经过，由于容量为正无穷，不会被最小割取到；因此最小割，必定选与之相连的源汇边（至少一个），简单割与点覆盖一一对应，且最小割为简单割

【最大点权独立模型】

对原二分图每条边，满足最多取两个端点中的一个，求所取点权最大和

由定义知，该模型为点权覆盖对偶问题，答案=所有点权和-最小割容量

【分数规划模型】

指使得目标分数函数（分母非负）最优化；二分答案，猜测一个参数g，构造评价函数h(g)，使其最优化

h(g)满足单调递减；h(g)最优值=0，则此时对应原最优值；h(g)最优值>0，调大g；h(g)最优值< 0，调小g

求h(g)最优值时，常常转化为最大权闭合图或者直接应用最小割模型

【混合图欧拉路模型】

【异或割问题】

此类问题涉及到，边权等于两顶点权的异或值；常常将位拆开，独立考虑，因为二进制彼此独立，答案可以按照贡献加权合成

而只考虑一位的01取值，原图可以转化为一个二分图；源s连所有0的点，所有1的点连汇t，容量正无穷；二分图中改有向边，容量为1；此时最小割只会取所有二分图中的边，且只有这些边边权才为1，也就是说最小割就是这一位上的边权和

经典例题：最优标号

已知一些点标号，构造其他点标号，使得总边权最小；考虑一位，标号确定的点，固定在S或者T集合中（容量正无穷），其他点01两类可以自由选择（容量为1），相当于求最小割（割与不确定点01状态选择是一一对应的），等于位上的最小边权和

【双权顶点集分划决策混合割模型】双权分划

问题：一般无向图，把顶点集分划为两部分，分到第一部分的点的所有第一点权和为a，分到第二部分的点的所有第二点权和为b，为了分划而割开的所有边权和为c，题目要求最优化f(a,b,c)，f是线性组合

构图的时候，用一分图的技巧，源s连每个点，容量为每个点的第一点权，每个点连汇t，容量为每个点的第二点权；其他所有的边，改成两条双向边，容量为原有的边权。注意，容量均有可能乘些系数。

题目所求的答案或者等于此图的最小割，或者等于所有点权和-最小割

这个模型的用途在于，可以化简一些目标函数为最小割模型，做法是把目标函数改成：点的贡献和与割的线性组合表达式，找到上述模型的点的双点权贡献的表达式，套用求混合割即可

经典例题：最大密度子图，二分答案后，会转化为一个新的目标函数，涉及到点权和边权，表达式转化后，可以转化为上述模型（类似的目标函数都可以）

【依赖关系建图技巧】

图中的节点与边的或者节点与节点的依赖关系，都容易转化为最大权闭合图模型；而如果是简单的自然依赖（边对两个端点的依赖），可以构造一个含点权与边权的目标函数表达式，最终转化成上述双权分划模型（按照点的贡献拆分表达式）

【位置方案建图技巧】

当一些序列问题，位置数目，与每个位置可选的方案都是确定的，却数目不大的时候，容易想到网络流，就是普通的二分图模型，位置和方案，各在一方，边表可选择，流表选择

【全局最小割】

【多源多汇问题】

加超级源点s，超级汇点t，s连所有源点，容量+oo，所有汇点连t，容量+oo

【最大流构造字典序最小的方案】

求完最大流之后，依次枚举边（优先级须从高开始），屏蔽这条边，再做最大流看是否改变

【无源汇上下界可行流】

加源s汇t，令M[i]=i这个点下界流入和-下界流出和，如果M[i]>=0，s连之，否则该点连t，容量均为绝对值M[i]。对该网络求最大流，如果源汇边均满流，则有解，否则无解。每条边的实际流量=当前流量+此边下界。

【有源汇上下界最大最小流可行流】

t连到s，容量设为x，下界设为y，此边的实际流量等于原图有源汇的流

可行流：x=oo,y=0，跑无源汇可行流

最大流：x=oo,二分下界y，跑无源汇可行流check

最小流：y=0,二分上界x，跑无源汇可行流check

流方案的构造同无源汇

【多次连续求最大流问题：dancing links】

【最小顶点覆盖】

最小顶点覆盖=最大匹配

证明：显然，最小顶点覆盖>=最大匹配，对最大匹配中的每个边，选一个合适的点（交错轨链接点）覆盖它，剩下的点，只有可能与选中的点相连，从而也被覆盖，否则会形成新的增广交错路径，则与最大匹配矛盾

【最大独立集】

最大独立集=顶点总数-最大匹配

【最小路径覆盖模型】

最小路径覆盖问题：在一个有向无环图中，从一些顶点出发，能遍历图上所有的顶点，要求初始选择最小的顶点数且顶点不重复遍历。选择不相交的简单路径，这些路径覆盖图中所有的顶点。

有向无环图DAG：最小路径覆盖数 = 节点数 - 最大匹配数

注意：如果路径可以相交，要先用floyed，对原图求一次传递闭包，然后再转化为二分图

【最小边覆盖模型】

二分图中最小边覆盖=顶点数-最小顶点覆盖（最大匹配）

极小边覆盖定义：若边覆盖E中的任何真子集都不是边覆盖集，则称E是极小边覆盖集。

最小边覆盖定义：实质是个边集，这个集合里的边能覆盖所有的点，最小边覆盖是满足这个要求的所有边集中边数最少的一个。

证明：设最大匹配数为m，总顶点数为n。为了使边数最少，又因为一条边最多能干掉两个点，所以尽量用边干掉两个点。也就是取有匹配的那些边，当然这些边是越多越好，那就是最大匹配了，所以先用最大匹配数目的边干掉大多数点。剩下的解决没有被匹配的点，就只能一条边干掉一个点了，设这些数目为a，显然，2m+a=n，而最小边覆盖=m+a，所以最小边覆盖=（2m+a）-m=n-m。

【最大团模型】

团定义：图的极大完全子图

最大团：节点数量最多的团，可能不唯一

补图：点集相同，边的存在性取反的图

团与独立集的关系：图的团与补图的独立集是一一对应的

图的色数：最少可用的颜色数量，对图的节点染色，使得同一条边两端点异色

故：图的最大团=补图的最大独立集，图的色数=最大团的节点个数

搜索算法的一个最常用剪枝技巧：如果剩余未考虑的顶点数加上团中顶点数不大于当前解的顶点数，就剪枝

常求的量有：最大团的节点数目，最大团的个数，极大团的个数，构造一个方案等

经典例题：给了平面上n个点，要求选出k个点来，使得这k个点中，距离最近的两个点的距离最大。二分答案，大等于答案的点对加边，对此图跑最大团，求节点个数；与k比较，调整二分的边界。

【一般无向图的最大独立集模型】

直接转化为补图的最大团问题

经典例题：无向图点染色，一条边两端点不可同时染黑色，求最多染黑的节点个数

【上下界费用流】

【边不交多路径最短路模型】

加超级源汇，连接源汇边，费用为0，容量为该源点（指起点）需要取的路径数目k；所有中间有向边，容量为1，费用为代价花费或者边长等

【点不交多路径最短路模型】

中间点不可走多次，拆点为边，入点连接出点，容量为1，费用为0，入点接入边，出点引出边，转化为边不交路径问题

【回路技巧】

在最大流模型中，有时候会遇到回路，这是说一个流既可以直接流入汇点，也可以选择暂时不流入，而是对以前的对象产生影响；其实，值得注意的是，在实际的流分布中，是不会形成环的，环只是容量非0边交错的表象而已，最短增广路算法的性质可以给出解释

【网络的化简·合并点技巧】

【容量叠加原理】

在最小割模型中，如果割一条边表示损失边权，那么当一条边带多权，或者遇到下面无法用一个权很方便的代表损失时，我们常常使用平摊边权，然后叠加的手段来方便地转化为最小割模型

【损失方程组平摊容量思想】

在一些复杂的比较棘手的问题中，我们无法直接使用最小割的容量来准确地刻画某些方案的损失。那么我们需要分情况讨论，列出容量的方程组，然后解出每一类边上的容量，然后叠加。我们首先需要虚拟一个合理的网络架构，来表示各个对象之间的关系，然后设置未知数表示不同种类边上的平摊容量，列一个损失方程组。

经典例题:无向图点边均带双权，要把点集分为1,2两部分，1中点边获取第一权利益，2中第二权，最大化利益和，求方案。

【最大最小补集转化思想】

有的题目是求最大值，其实有时候并不是最大流模型；我们可以设定一个额定值，做减法构造成一种损失模型。使得最终方案损失最小，这就与最小割的含义对应了。

【多选一链式拓扑模型】

这是说有n个对象，每个对象有m个选择(选一个)，满足某些对象的选择编号要在另一些的后面，在可选的意义最大化利益和。如果不考虑拓扑的限制，可以为每个对象引一条s-t链，将选择按照编号排列在上面，注意边权要转化为损失，点权往往是二元组表示具体对象的具体选择，点权化边权。这时候每个对象彼此独立，加上拓扑，在有限制关系的对象之间加有向边，容量正无穷。具体来说，是(a,i)向(b,i+1)等类似的边。这种模型要注意选择的标号是一致的，也就是说对每个对象都基本一致，而且选择的标号要满足全序可比的性质。

经典例题:选课问题，选m门课，每学期一门课，要满足k个课程组时间上的拓扑限制，最大化得分和，给定每门课每学期得分矩阵。

【独立染色补偿模型】

这是说这样一类问题：我们要对诸多对象进行二选一决策，每个选择都有其收益（往往转化为损失），不同的对象之间有可能有关系：如果其某些决策相同或者不同，会带来额外的收益或者损失。我们要最大化收益，即最小化损失，可以这样思考：先独立的考虑每个对象，考虑一个简单的最小割选择模型，这些对象两两互不影响，然后我们考虑有关系的对象组合，他们会产生额外的损失（收益为负损失，可以转化为正权），设想通过在原网络上加一些边，构成一些额外的增广路，使得如果同一组对象同时取某个相同的决策，最小割不得不再割去一些额外的补偿边。有时候，便于补偿增广路的形成，我们会把对象黑白染色分成两类，同一组的两个对象要异色，交换第二类对象的s和t边，然后在对象之间连接有向边，这表示补偿容量，满足如果同一组两个对象某种决策相同，就必须割去该补偿容量；如果是同一组取不同决策，需要额外花费，则不需要染色，直接对象组连接无向边即可，可以参见双权分划模型。

经典例题：GCJ2008final:给你一个n*m的网格，一些格子已经染成白色，另一些黑色，剩下的问号不确定，让你将所有问号都确定为黑白之一，求一种方案，使得总效益最大；其中，效益计算方法为，所有黑色格子邻接的白色格子数目之和（比如：一个黑色格子，与三个白的相邻，那么此格子效益为3；白色格子是没有效益的）。思路就是：独立考虑每个问号格子，黑白两种决策损失（白4，黑：周边黑数目乘2），然后对网格染色，相邻问号为一组，连有向边，容量为补偿容量2，套用上面的模型。

【对象有序的费用决策流结构:在通路流上作决策】

经典问题：给一个序列，选择若干元素，使得和最大，满足限制：相邻元素下标差不小于k。

这是在费用流意义下，常见的一个建模方式。通路流:其实就是一个简单st流结构，s连接第一个对象，最后一个对象连接t，所有对象在中间顺次连接，均为有向边，容量均为k，费用均为0。可以看到这个st增广路中的每一段的活力是相同的，蕴含着k个通路流。这k个流可以看作是彼此独立的流，具有独立做决策的能力，并且一个流可以同时选择多个对象，这是优点，其缺点是无法限制一个流选择对象的上界个数，另一方面，这个简单的结构的妙处在于每一段的费用是0，这看起来微不足道，但其实大有文章，首先流从通路通过，费用是0，就不会叠加到总答案中，体现的决策就是此处不选，另外，我们扩展这个结构，加上对象之间的决策费用的边，在最大费用最大流的意义下，流会优先选择对象而不是消极的不选，这样就自然不会导致假决策的废流(在有可能的情况下，流不会自发的从s直接走到t，期间什么也不做，一个对象也不选)。显然，后者赋予了流的决策能力。

流在做决策的时候，如果选择了一个对象，那么排在这个对象后面的指定多个对象就会被跳过，而无法参与决策（或者理解成直接不可选，这体现了拓扑关系下，靠在一起的几个对象之间存在利益冲突的矛盾思想），这是这个决策模型的特点。这使得决策蕴含的限制条件比较单一，并且决策对象需要有较明显且严格的拓扑关系，因此常常应用于序列上的元素选择。具体建模方法，结合下面一个模型。


模型结构扩展：

1.如果遇到等价关系（如同余），将对象进一步划分成若干等价类，而每个等价类中拟一个简单的线性通路流结构，则整个对象集合可以对应一个并联的网络结构

2.如果对象的限制更强，要求每个指定对象后只可以跟一些指定的后续对象，则先拆点，出点连每个合法后继的入点，费用为0，容量为无穷或最大流，每个对象内部需要引两条边（入到出），一条是通路边，边权同上，另一条容量为1，费用为价值（或者是负价值），其他连接边不变

3.全局强制限流，拆源点，内部容量为最大限流容量




【多区间频率限制（同上界）】

经典问题：把上面的问题的限制条件改为，原序列的任意一个长度为m的连续子序列中，不能选择超过k个对象。注意到，这种限制的强度很大，看起来是简单的流问题，却无法用最大流来直接限制频率，这是因为，一个决策对象，可以属于多个限制区间（如上述的长度为m的连续子序列），一个简单的决策流，无法同时流入多个卡流节点/边，造成根本上无法进行精准的限制；所以这个问题，要先转化限制，将其弱化。将一个频率看成一个通路流，一个通路流选择的多个对象，下标差不小于限制区间的长度，这样保证一个流走过选择到的对象互不冲突；然后回到原来的限制，将k个通路流同时放出，决策对象容量是1，费用是价值，可以保证一个决策对象，只会被最多一个通路流取走，不会重复取；并且对于一个决策对象，考察与其他被选对象的关系，在同一个通路流中的其他对象，距离它不小于L，因此距离它小于L的对象为0个，其他通路流，注意到每条最多有1个距离与它小于L，因此对于任意一个被选的对象，其他被选对象中，方圆k的有不超过通路流的个数-1.亦即，连续m长度连续区间，我们最多选了k个对象，这说明构造的方案的可行性；下面证明：可以覆盖到最优的方案。考虑一个最优的方案，我们顺次取走被选的对象，每一个轮回走一趟，能取就取，由于【1,m】【m+1,2*m】【2*m+1,3*m】...每个区间不超过k个，所以k轮一定足够了，所以我们不会漏掉最优的方案。

这个问题，体现的是将区间频率限制，拆分转化为几个（频率个）简单的通路流的靠近对象的矛盾限制。在通路结构上，第i个对象连接第i+m个对象，如果不存在直接连接t，都是容量1，费用为起点对象的价值。

【费用流模型的费用等量叠加原理】

这是说这样一个性质：将原网络的每条边的费用增加x，最后的结果会增加，单独做每条边费用为x的费用流跑出的结果。





